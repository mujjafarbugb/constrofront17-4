import{u as q,b as J,r as s,j as a,a as e,F as j,L as C,Q as g}from"./index.8d209275.js";import{H as Q}from"./HomeBredCurbs.56396cea.js";import{M as z,B as G}from"./Modal.451c7296.js";import{T as K}from"./Textinput.3d307643.js";import{I as W,M as X}from"./index.0514ba4e.js";import{c as Y,u as Z,o as ee}from"./array.26b679e0.js";import{u as te}from"./formik.esm.17944b7d.js";import{a as u}from"./axios.74c9240f.js";import"./index.esm.f6a38425.js";import"./iconBase.3b0c2950.js";const S=Y({}),be=()=>{q();const{id:P}=J();console.log(9,P);const R=localStorage.getItem("profile"),p=JSON.parse(R);console.log(31,p._id);const[f,w]=s.exports.useState(""),[F,D]=s.exports.useState([]),[y,v]=s.exports.useState([]),[L,b]=s.exports.useState(!1),[N,B]=s.exports.useState(!1),[o,n]=s.exports.useState({projectName:"",buildings:"",city:"",location:"",remark:""}),M=()=>new Date().toLocaleString("en-US",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1}),[r,d]=s.exports.useState({receiverId:p._id,buildings:"",projectName:"",city:"",location:"",remark:"",regFrom:"web",regOn:M(),isActive:!0}),_=t=>{if(console.log(87,r),r){if(!r.projectName||!r.city||!r.location||!r.remark||!r.buildings){g.error("Please fill all required fields",{position:"top-right"});return}({...r},u.post("https://constrobackend17-4.onrender.com/api/post_projects",r).then(l=>{l.data,console.log(46,l),g.success("Submission successful!",{position:"top-right"}),b(!1),B(!N)}).catch(l=>{console.error("API Error:",l)}))}};s.exports.useEffect(()=>{u.get("https://constrobackend17-4.onrender.com/api/getAll_Cities_ddl").then(t=>{console.log(79,t.data.Result),D(t.data.Result),n(t.data.Result),n(r)}).catch(t=>{console.log(t)}),u.get(`https://constrobackend17-4.onrender.com/api/getProjectByReceiver/${p._id}`).then(t=>{console.log(100,t.data.Result),v(t.data.Result)}).catch(t=>{console.log(t)})},[N]);const{register:i,formState:{errors:m},handleSubmit:ae}=Z({resolver:ee(S),mode:"all"});te({initialValues:{},validationSchema:S,onSubmit:t=>{console.log(122,t)}});const I=t=>{const l=t.target.value;w(l),d({...r,city:l})},A=()=>{window.history.back()},U=t=>{console.log(600,t),n(t)},O=t=>{const{_id:l,projectName:k,buildings:E,city:re,location:H,remark:V,selectedCity:T}=t,c={projectName:k,buildings:E,city:T,location:H,remark:V};console.log(199,"Updated Data:",c),u.put(`https://constrobackend17-4.onrender.com/api/update_projects/${l}`,c).then(h=>{console.log(46,h),g.success("Update Project Successfully!",{position:"top-right"});const $=y.map(x=>x._id===l?{...x,projectName:c.projectName,buildings:c.buildings,city:c.city,location:c.location,remark:c.remark}:x);v($)}).catch(h=>{console.error("API Error:",h)})};return console.log(601,o),a("div",{children:[a("div",{className:"flex justify-between items-center",children:[e(Q,{title:"List of Projects"}),e("div",{children:e(z,{title:"",label:" + Add Projects ",labelClass:"bg-[#00adee] hover:bg-[#6fcaeb] text-white",uncontrol:!0,isOpen:L,onClose:()=>b(!1),footerContent:e(G,{text:"Add Project",className:"bg-[#00adee] hover:bg-[#6fcaeb] text-white ",onClick:()=>{_(),b(!1),onClose()}}),children:a("div",{className:"text-xs text-slate-600 dark:text-slate-300 mt-2",children:[a("div",{class:"input-group mb-2 mt-3",children:[e("label",{for:"formFile",class:"form-label",children:"Project Name"}),e("input",{type:"text",name:"projectName",class:"form-control",placeholder:"","aria-label":"Recipient's username","aria-describedby":"button-addon2",register:i,error:m.projectName,value:r.projectName,onChange:t=>{d({...r,projectName:t.target.value})}})]}),a("div",{class:"input-group mb-3 mt-3",children:[e("label",{for:"formFile",class:"form-label",children:"Select City"}),a("select",{name:"city",class:"form-select text-sm text-slate-500","aria-label":"Default select example",onChange:I,value:f,children:[e("option",{value:"",selected:!0,children:"Select city"}),F.map((t,l)=>e(j,{children:e("option",{value:t._id,children:t.city})}))]})]}),a("div",{class:"input-group mb-2 mt-3",children:[e("label",{for:"formFile",class:"form-label",children:"Building Name"}),e("input",{type:"text",name:"buildings",class:"form-control",placeholder:"","aria-label":"Recipient's username","aria-describedby":"button-addon2",register:i,error:m.buildings,value:r.buildings,onChange:t=>{d({...r,buildings:t.target.value})}})]}),a("div",{class:"input-group mb-2 mt-3",children:[e("label",{for:"formFile",class:"form-label",children:"Location"}),e("input",{type:"text",name:"location",class:"form-control",placeholder:"","aria-label":"Recipient's username","aria-describedby":"button-addon2",register:i,error:m.location,value:r.location,onChange:t=>{d({...r,location:t.target.value})}})]}),a("div",{class:"input-group mb-2 mt-3",children:[e("label",{for:"formFile",class:"form-label",children:"Remark"}),e("input",{type:"text",name:"remark",class:"form-control",placeholder:"","aria-label":"Recipient's username","aria-describedby":"button-addon2",register:i,error:m.remark,value:r.remark,onChange:t=>{d({...r,remark:t.target.value})}})]})]})})})]}),a("div",{className:"flex items-center text-slate-400 ",children:[a(C,{to:"",className:"flex items-center text-sm hover:underline hover:font-semibold hover:text-blue-400 cursor-pointer gap-1",onClick:A,children:[e(W,{className:"text-xl font-semibold"}),"Back"]}),e("span",{className:"mx-2",children:" / "}),a(C,{to:"/dashboard",className:"flex items-center text-sm  hover:underline hover:font-semibold hover:text-blue-400 cursor-pointer gap-1",children:[e(X,{className:"text-lg font-semibold"}),"Home"]})]}),e("div",{class:"overflow-x-auto",children:a("table",{class:"table-auto w-full shadow-sm rounded-md mt-3",children:[e("thead",{class:"border border-collapse bg-slate-50",children:a("tr",{className:" rounded-md",children:[e("th",{class:"px-4 py-2 text-center border",children:"Project"}),e("th",{class:"px-4 py-2 text-center border",children:"Buildings"}),e("th",{class:"px-4 py-2 text-center border",children:"City"}),e("th",{class:"px-4 py-2 text-center border",children:"Location"}),e("th",{class:"px-4 py-2 text-center border",children:"Remark"}),e("th",{class:"px-4 py-2 text-center border"})]})}),a("tbody",{children:[e("div",{class:"modal fade",id:"exampleModal",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true",children:e("div",{class:"modal-dialog",children:a("div",{class:"modal-content",children:[a("div",{class:"modal-header text-white bg-[#00adee]",children:[e("h1",{class:"modal-title fs-5",id:"exampleModalLabel"}),e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})]}),e("div",{class:"modal-body",children:a("form",{children:[a("div",{className:"input-group mb-2 mt-2",children:[e("label",{htmlFor:"formFile",className:"form-label text-left",children:"Building Name"}),e("input",{type:"text",name:"buildings",className:"form-control",placeholder:"","aria-label":"Recipient's username","aria-describedby":"button-addon2",register:i,value:o.buildings,defaultValue:o.buildings,onChange:t=>n({...o,buildings:t.target.value})})]}),e("label",{for:"projectName",class:"form-label text-left",children:"Remark"}),e(K,{name:"remark",type:"text",placeholder:"",register:i,className:"",value:o.remark,defaultValue:o.remark,onChange:t=>n({...o,remark:t.target.value})})]})}),a("div",{class:"modal-footer",children:[e("button",{type:"button",class:"btn btn-secondary border-0","data-bs-dismiss":"modal",children:"Cancel"}),e("button",{type:"button",class:"btn btn-primary border-0 bg-[#00adee]",onClick:t=>{O(o)},children:"Update Project"})]})]})})}),y.map((t,l)=>e(j,{children:a("tr",{className:"hover:bg-[#f8f8f8] shadow-sm",children:[e("td",{class:"px-4 py-2 text-center text-sm text-slate-500",children:t.projectName}),e("td",{class:"px-4 py-2 text-center text-sm text-slate-500",children:t.buildings}),e("td",{class:"px-4 py-2 text-center text-sm text-slate-500",children:t.city.city}),e("td",{class:"px-4 py-2 text-center text-sm text-slate-500",children:t.location}),e("td",{class:"px-4 py-2 text-center text-sm text-slate-500",children:t.remark}),e("td",{className:"px-4 py-2 text-center flex justify-center text-sm text-slate-500 ",children:e("div",{className:"cursor-pointer hover:text-[#00adee]",children:e("button",{type:"button",class:"btn border-0","data-bs-toggle":"modal","data-bs-target":"#exampleModal","data-bs-whatever":"@mdo",onClick:k=>{U(t)}})})})]})}))]})]})})]})};export{be as default};
